branches:  
  only:
    - master
    - staging
    - production
services:  
  #Enable docker service inside travis
  - docker
before_install:  
  - docker login -e="$DOCKER_EMAIL" -u="$DOCKER_USERNAME" -p="$DOCKER_PASSWORD"
script: 
  # build the images
  - docker build --no-cache -t 3blades/nbviewer nbviewer/.
  - docker push 3blades/nbviewer:latest

script:
  # build
  - docker build --no-cache -t $DOCKER_IMAGE_NAME .
  # tag the build
  - docker tag $DOCKER_IMAGE_NAME $DOCKER_IMAGE_NAME
  # push the image to the repository
  - docker push $DOCKER_IMAGE_NAME:latest
notifications:
  slack: 3blades:kDsouoROcGOm58UyVIvH1XhV 
env:
  - $DOCKER_IMAGE_NAME=3blades/nbviewer